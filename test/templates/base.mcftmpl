<%def name="increment(count)">
execute unless score ${var} funcs matches -1.. run function ${var}_init
scoreboard players add ${var} funcs 1
execute unless score ${var} funcs matches 0..${count - 1} run scoreboard players set ${var} funcs 0
</%def>

<%def name="when(i)">execute if score ${var} funcs matches ${i} run</%def>

<%def name="loop(collection)">
${increment(len(collection))}

% for thing in collection:
${caller.body(when, loop.index, thing)}
% endfor
</%def>

<%def name="bounce(collection)">
<%
    backwards = collection[1:-1]
    backwards.reverse()
    merged = collection + backwards 
%>
${increment(len(merged))}

% for thing in merged:
${caller.body(when, loop.index, thing)}
% endfor
</%def>

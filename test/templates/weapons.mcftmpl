<%namespace name="base"  file="base.mcftmpl"/>
<%
    horse_materials = ("iron", "golden", "diamond")
    materials = ("stone", "wooden") + horse_materials 
    blocks1 = (Thing("Cobblestone"), Thing("Oak Log"), Thing("Iron Ore"), Thing("Gold Ore"), Thing("Diamond Ore"))
    source1 = (Thing("Cobblestone"), Thing("Oak Sapling"), Thing("Iron Nugget"), Thing("Gold Nugget"), Thing("Diamond"))
    blocks2 = (Thing("Stone"), Thing("Oak Wood"), Thing("Iron Block"), Thing("Gold Block"), Thing("Diamond Block"))
    source2 = (Thing("Stone"), Thing("Oak Planks"), Thing("Iron Ingot"), Thing("Gold Ingot"), Thing("Diamond"))
    horse_armor = (Item("%s Horse Armor" % n) for n in horse_materials)
%>

<%base:loop collection="${materials}" args="when,i,thing">
% if thing in horse_materials:
${when(i)} data merge entity @e[tag=armor_horse,limit=1] {ArmorItem:{id:"minecraft:${thing}_horse_armor",Count:1}}
${when(i)} data merge entity @e[tag=horse_armor_frame,limit=1] {Item:{id:${thing}_horse_armor},Count:1,ItemRotation:0}
% else:
<%doc> This is an attempt to remove the horse armor, but nothing seems to work </%doc>\
${when(i)} data merge entity @e[tag=armor_horse,limit=1] {ArmorItem:{id:"minecraft:iron_horse_armor",Count:0}}
${when(i)} data merge entity @e[tag=horse_armor_frame,limit=1] {Item:{id:iron_horse_armor},Count:0}
% endif

${when(i)} data merge entity @e[tag=shovel_stand,limit=1] {HandItems:[{},{id:${thing}_shovel,Count:1}]}
${when(i)} data merge entity @e[tag=hoe_stand,limit=1] {HandItems:[{},{id:${thing}_hoe,Count:1}]}

% if thing in horse_materials:
${when(i)} data merge entity @e[tag=sword_stand,limit=1] {ArmorItems:[{id:${thing}_boots,Count:1},{id:${thing}_leggings,Count:1},{id:${thing}_chestplate,Count:1},{id:${thing}_helmet,Count:1}],HandItems:[{id:${thing}_sword,Count:1},{id:shield,Count:1}],CustomName:${text(thing.capitalize())}}
% elif thing == "stone":
${when(i)} data merge entity @e[tag=sword_stand,limit=1] {ShowArms:True,ArmorItems:[],HandItems:[{id:wooden_sword,Count:1},{id:shield,Count:1}],CustomName:"\"Wood\""}
% else:
${when(i)} data merge entity @e[tag=sword_stand,limit=1] {ShowArms:True,ArmorItems:[{id:leather_boots,Count:1},{id:leather_leggings,Count:1},{id:leather_chestplate,Count:1},{id:leather_helmet,Count:1}],HandItems:[{id:stone_sword,Count:1},{id:shield,Count:1}],CustomName:"\"Stone\"",CustomNameVisible:True}
% endif

${when(i)} data merge entity @e[tag=axe_stand,limit=1] {HandItems:[{id:${thing}_axe,Count:1}]}
${when(i)} data merge entity @e[tag=pickaxe_stand,limit=1] {HandItems:[{id:${thing}_pickaxe,Count:1}]}

${when(i)} fill ~-3 ~2 ~1 ~-4 ~2 ~1 ${blocks2[i].full_id()}
${when(i)} setblock ~-3 ~2 ~3 ${blocks1[i].full_id()}
${when(i)} setblock ~-3 ~2 ~-1 ${blocks1[i].full_id()}
${when(i)} setblock ~-4 ~3 ~3 ${blocks1[i].full_id()}
${when(i)} setblock ~-4 ~3 ~1 ${blocks1[i].full_id()}
${when(i)} setblock ~-4 ~3 ~-1 ${blocks1[i].full_id()}
${when(i)} data merge entity @e[tag=source1_frame,limit=1] {Item:{id:${source1[i].id}},Count:1,ItemRotation:0}
${when(i)} data merge entity @e[tag=source2_frame,limit=1] {Item:{id:${source2[i].id}},Count:1,ItemRotation:0}
</%base:loop>

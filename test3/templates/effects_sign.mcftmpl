<%namespace file="effects/effect_base.mcftmpl" import="*"/>\
<%def name="sign_nbt(i, action)">Text${i+1}:"{\"text\":\"${lines[i]}\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"execute ${at_center()} run ${action}\"}}"</%def>
<%def name="sign_local_nbt(i, action)">Text${i+1}:"{\"text\":\"${lines[i]}\",\"clickEvent\":{\"action\":\"run_command\",\"value\":\"${action}\"}}"</%def>

execute at @e[tag=signer] run setblock ^${x} ^${y} ^ wall_sign[facing=${frame.facing}]{\
${sign_nbt(0, "setblock ~ ~-3 ~ redstone_block")},\
${sign_nbt(1, r"data merge block ~0 ~-4 ~-2 {Command:\\\"execute at @e[tag=effects_home] positioned ~ ~2 ~ run function v3:effects/%s_init\\\"}" % effect.id)},\
${sign_nbt(2, r"data merge block ~-1 ~-2 ~0 {Command:\\\"execute at @e[tag=effects_home] positioned ~ ~2 ~ run function v3:effects/%s\\\"}" % effect.id)}\
%if effect.name != "Off":
,${sign_local_nbt(3, "setblock ^%d ^0 ^%d emerald_block" % (frame.block_at[0], frame.block_at[1]))}\
%endif
} replace
